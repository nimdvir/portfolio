/*! 20240613-38-RELEASE */

(o=>{const e="top",t="https://cdn.taboola.com",i="http://localhost:9876",n=`${t}/libtrc/static/topics/taboola-browsing-topics.html`,r=`tbl-browsing-topics-iframe-${100*Math.random()}`;function s(){try{if(!TRC.topics)return;a(TRC.topics)}catch(o){__trcWarn(`failed to save handed Google Topics at local storage: ${o.message}`)}}function a(o){try{const t=[];for(let e=0;e<o.length;e++)if(o[e].topic&&o[e].taxonomyVersion){const i={topic:o[e].topic,taxonomy:o[e].taxonomyVersion,model:o[e].modelVersion,config:o[e].configVersion,i:o[e].topic,v:o[e].taxonomyVersion};t.push(i)}if(!t.length)return;TRC.pageManager.storeValue(e,JSON.stringify(t)),m()}catch(o){__trcWarn(`failed to save Google Topics at local storage: ${o.message}`)}}function c(){let o,t;try{if((t=(o=TRC.pageManager.getValue(e))?JSON.parse(o):null)&&t.length>0)return t}catch(o){__trcWarn(`failed to read Google Topics from local storage: ${o.message}`)}}function l(){window.addEventListener("message",o=>{if(o.origin!==t&&o.origin!==i)return;const e=o.data;e.error&&__trcWarn(`Error in browsing topics iframe: ${e.error}`),e.policyMessage&&__trcWarn(e.policyMessage),e.topics&&e.topics.length&&a(e.topics)})}function g(){const e=new MutationObserver(o=>{o.forEach(o=>{o.addedNodes.forEach(o=>{"BODY"===o.nodeName&&(e.disconnect(),p())})})});e.observe(o.documentElement,{childList:!0,subtree:!1})}function p(){if(!o.body)return void g();const e=o.createElement("iframe");e.id=r,e.src=n,e.style.width="0",e.style.height="0",e.style.display="none",l(),o.body.appendChild(e)}function d(){return"browsingTopics"in o&&o.featurePolicy&&o.featurePolicy.allowsFeature("browsing-topics")}function f(){d()&&p()}function m(){const e=o.getElementById(r);e&&e.remove()}s(),f(),TRC.GoogleTopicsApi={readGoogleTopicsApiFromLocalStorage:c},window._trcIsUTactive&&(TRC.GoogleTopicsApi.testHelpers={browsingTopicsTestPromise:()=>(s(),p(),new Promise(o=>{window.addEventListener("message",e=>{e.origin===i&&e.data.topics&&o(c())})}))})})(document);