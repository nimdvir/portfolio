!function(){"use strict";var extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function __extends(t,e){function i(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var VideoQuartile=(k.start=function(){return new k("AdVideoStart",0,new k("AdVideoFirstQuartile",25,new k("AdVideoMidpoint",50,new k("AdVideoThirdQuartile",75,new k("AdVideoComplete",99,new k("AdVideoComplete",100,null))))))},k.prototype.isReached=function(t){return null!==this.nextQuartile&&this.progress<t},k.prototype.next=function(){return this.nextQuartile||this},k);function k(t,e,i){this.event=t,this.progress=e,this.nextQuartile=i}var BaseVpaidVideoPlayer=function(){function BaseVpaidVideoPlayer(){this.eventsCallbacks={},this.viewabilityWatches=[],this.attributes_={companions:"",desiredBitrate:256,duration:-2,expanded:!1,height:720,icons:!0,linear:!0,remainingTime:-2,skippableState:!0,viewMode:"normal",width:1280,volume:1,skipOffsetSeconds:5,skipped:!1}}return BaseVpaidVideoPlayer.prototype.handshakeVersion=function(t){return"2.0"},BaseVpaidVideoPlayer.prototype.getAdRemainingTime=function(){return this.attributes_.remainingTime},BaseVpaidVideoPlayer.prototype.getAdExpanded=function(){return this.log("getAdExpanded"),this.attributes_.expanded},BaseVpaidVideoPlayer.prototype.getAdDuration=function(){return this.attributes_.duration},BaseVpaidVideoPlayer.prototype.setAdDuration=function(t){this.attributes_.duration=t,this.callEvent("AdDurationChange")},BaseVpaidVideoPlayer.prototype.getAdHeight=function(){return this.attributes_.height},BaseVpaidVideoPlayer.prototype.getAdWidth=function(){return this.attributes_.width},BaseVpaidVideoPlayer.prototype.getAdLinear=function(){return this.attributes_.linear},BaseVpaidVideoPlayer.prototype.getAdCompanions=function(){return this.attributes_.companions},BaseVpaidVideoPlayer.prototype.getAdIcons=function(){return this.attributes_.icons},BaseVpaidVideoPlayer.prototype.getViewMode=function(){return this.attributes_.viewMode},BaseVpaidVideoPlayer.prototype.getAdVolume=function(){return this.attributes_.volume},BaseVpaidVideoPlayer.prototype.initTracking=function(){var setupEvent=new Event("setupModules");eval(this.adParameters.javascriptBase64),this.log("AdParameters got evaluated.");var payload=window.vpaidPayload;this.viewabilityVideo=payload&&payload.viewability(this.slot),this.sendViewabilityData=payload&&payload.sendViewabilityData,this.viewabilityVideo?this.viewabilityWatches.push(this.viewabilityVideo.onHalfVisibilityTimeout(this.isVideoPlaying.bind(this)),this.viewabilityVideo.onFullVisibilityCumulateTime(this.isVideoPlaying.bind(this))):this.log("ViewabilityVideo object evaluated to null",!1,!0),this.lastQuartile=VideoQuartile.start(),document.dispatchEvent(setupEvent)},BaseVpaidVideoPlayer.prototype._startViewabilityWatches=function(){this.viewabilityWatches.forEach(function(t){return t.start()})},BaseVpaidVideoPlayer.prototype._stopViewabilityWatches=function(){this.viewabilityWatches.forEach(function(t){return t.stop()})},BaseVpaidVideoPlayer.prototype.checkCompletion=function(){var t;0<this.getAdDuration()&&-2!=this.getAdRemainingTime()&&(t=100*(this.getAdDuration()-this.getAdRemainingTime())/this.getAdDuration(),this.lastQuartile.isReached(t)&&(this.callEvent(this.lastQuartile.event),this.viewabilityVideo&&this.sendViewabilityData&&this.viewabilityVideo.isFullyVisible()&&this.sendViewabilityData(this.lastQuartile.event),this.lastQuartile=this.lastQuartile.next()))},BaseVpaidVideoPlayer.prototype.timeUpdateHandler=function(){this.fetchTimes(),this.checkCompletion()},BaseVpaidVideoPlayer.prototype.startAd=function(){var e=this;this.log("Starting ad");var t=this.doStartAd();void 0!==t?t.then(function(){e._startViewabilityWatches()}.bind(this)).catch(function(t){e.log(t,!0)}):this.log("Error in startAd in basic",!0),this.addAdChoiceIcon(),this.slot.style.cursor="pointer",this.slot.addEventListener("click",this.videoOnClick.bind(this),!1),this.callEvent("AdStarted"),this.callEvent("AdImpression")},BaseVpaidVideoPlayer.prototype.stopAd=function(){var t=this;this.log("Stopping ad"),clearInterval(this.intervalId),this.doStopAd(),setTimeout(function(){t.callEvent("AdStopped"),t._stopViewabilityWatches()},75)},BaseVpaidVideoPlayer.prototype.pauseAd=function(){this.log("pauseAd"),this.doPause(),this.callEvent("AdPaused"),this._stopViewabilityWatches(),clearInterval(this.intervalId)},BaseVpaidVideoPlayer.prototype.resumeAd=function(){var t=this;this.log("resumeAd");function e(){t.callEvent("AdPlaying"),t._startViewabilityWatches()}var i=this.doResumeAd();i?i.then(e):e(),this.intervalId=setInterval(function(){t.attributes_.remainingTime-=.25,t.callEvent("AdRemainingTimeChange")},250)},BaseVpaidVideoPlayer.prototype.resizeAd=function(t,e,i){this.log("resizeAd "+t+"x"+e+" "+i),this.attributes_.width=t,this.attributes_.height=e,this.attributes_.viewMode=i,this.doResizeAd(),this.callEvent("AdSizeChange")},BaseVpaidVideoPlayer.prototype.expandAd=function(){this.log("expandAd"),this.attributes_.expanded=!0,this.doExpandAd(),this.callEvent("AdExpandedChange")},BaseVpaidVideoPlayer.prototype.collapseAd=function(){this.log("collapseAd"),this.attributes_.expanded=!1,this.doCollapseAd(),this.callEvent("AdCollapsed")},BaseVpaidVideoPlayer.prototype.skipAd=function(){this.log("skipAd"),!this.attributes_.skipped&&this.getAdSkippableState()&&(this.attributes_.skipped=!0,this.doSkipAd(),this.callEvent("AdSkipped"),this._stopViewabilityWatches())},BaseVpaidVideoPlayer.prototype.setAdVolume=function(t){return 0<=t&&t<=1&&(this.getAdVolume()!==t&&(this.attributes_.volume=t,this.log("setAdVolume "+t),this.doSetAdVolume(),this.callEvent("AdVolumeChange")),!0)},BaseVpaidVideoPlayer.prototype.iconOnClick=function(){var e=this;this.log("Icon got clicked");var t=this.eventsCallbacks.AdClickThru;t&&t.forEach(function(t){return t.callback(e.adParameters.iconsClickUrl,"1",!0)})},BaseVpaidVideoPlayer.prototype.addAdChoiceIcon=function(){var t=this,e=document.createElement("img");e.src=this.adParameters.icons,e.style.position="absolute",e.style.width="19px",e.style.height="15px",e.style.right="0px",this.slot.appendChild(e),e.addEventListener("click",function(){return t.iconOnClick()},!1)},BaseVpaidVideoPlayer.prototype.subscribe=function(t,e,i){this.log("Subscribe "+e,!0);i=t.bind(i);void 0===this.eventsCallbacks[e]&&(this.eventsCallbacks[e]=[]),this.eventsCallbacks[e].push({callback:i,reference:t})},BaseVpaidVideoPlayer.prototype.unsubscribe=function(t,e){this.log("unsubscribe "+e,!0),void 0===this.eventsCallbacks[e]||0<=(t=this.eventsCallbacks[e].map(function(t){return t.reference}).indexOf(t))&&this.eventsCallbacks[e].splice(t,1)},BaseVpaidVideoPlayer.prototype.callEvent=function(t){t=this.eventsCallbacks[t];t&&t.forEach(function(t){return t.callback()})},BaseVpaidVideoPlayer.prototype.log=function(e,t,i){var a;void 0===i&&(i=!1),(t=void 0===t?!1:t)||(a=this.eventsCallbacks.AdLog)&&a.forEach(function(t){return t.callback(e)}),null!==(a=this.adParameters)&&void 0!==a&&a.debug&&(i?console.error(e):console.log(e))},BaseVpaidVideoPlayer}(),VpaidVideoPlayer=(_=BaseVpaidVideoPlayer,__extends(aa,_),aa.prototype.initAd=function(t,e,i,a,o,s){var n=this;this.attributes_.width=t,this.attributes_.height=e,this.slot=s.slot,this.videoSlot=s.videoSlot,this.adParameters=JSON.parse(o.AdParameters),this.log("initAd "+t+"x"+e+" "+i+" "+a),this.updateVideoSlot(),this.initTracking(),this.attributes_.skipOffsetSeconds=this.adParameters.skipOffsetSeconds;a=null;0<=this.attributes_.skipOffsetSeconds&&(a=this.createSkipButtonElement()).addEventListener("click",function(){return n.skipAd()},!1),this.listenToTimeUpdate(a),this.videoSlot.addEventListener("ended",function(){return n.stopAd()},!1),this.adParameters.thirdPartyTrackingParameters&&this.initThirdPartyTracking(this,this.slot,this.adParameters.thirdPartyTrackingParameters),this.callEvent("AdLoaded"),this.log("ad loaded")},aa.prototype.initThirdPartyTracking=function(t,e,i){},aa.prototype.isVideoPlaying=function(){return!this.videoSlot.paused},aa.prototype.getAdSkippableState=function(){return this.log("getAdSkippableState"),!this.attributes_.skipped&&0<=this.attributes_.skipOffsetSeconds&&this.attributes_.duration-this.getAdRemainingTime()>=this.attributes_.skipOffsetSeconds},aa.prototype.fetchTimes=function(){this.attributes_.remainingTime=this.videoSlot.duration-this.videoSlot.currentTime,this.attributes_.duration!==this.videoSlot.duration&&this.setAdDuration(this.videoSlot.duration)},aa.prototype.listenToTimeUpdate=function(t){var e,i=this;this.videoSlot.addEventListener("timeupdate",this.timeUpdateHandler.bind(this),!1),0<=this.attributes_.skipOffsetSeconds&&this.videoSlot.addEventListener("timeupdate",e=function(){i.videoSlot.currentTime>=i.attributes_.skipOffsetSeconds&&(i.callEvent("AdSkippableStateChange"),t&&i.slot&&i.slot.appendChild(t),i.videoSlot.removeEventListener("timeupdate",e))},!1)},aa.prototype.updateVideoSlot=function(){this.slot&&!this.videoSlot&&(this.videoSlot=document.createElement("video"),this.log("Warning: No video element passed to ad, creating element."),this.slot.appendChild(this.videoSlot),this.nestedVideoSlot=!0);for(var t=!1,e=0,i=this.adParameters.videos||[];e<i.length;e++){var a=i[e];if(this.videoSlot&&""!==this.videoSlot.canPlayType(a.mimetype)){this.videoSlot.setAttribute("src",a.url),t=!0;break}}t||this.callEvent("AdError")},aa.prototype.doResizeAd=function(){try{this.videoSlot&&(this.videoSlot.setAttribute("width",this.attributes_.width+""),this.videoSlot.setAttribute("height",this.attributes_.height+""),this.videoSlot.style.width=this.attributes_.width+"px",this.videoSlot.style.height=this.attributes_.height+"px")}catch(t){}},aa.prototype.doStartAd=function(){var t=this;this.videoSlot&&!this.nestedVideoSlot&&this.videoSlot.addEventListener("click",function(){return t.videoOnClick()},!1);var e=this.videoSlot.play();return e&&e.catch(function(){t.setAdVolume(0),t.videoSlot.muted=!0,t.videoSlot.play().catch(function(){t.setAdVolume(1),t.videoSlot.muted=!1,t.videoSlot.controls=!0})})},aa.prototype.doStopAd=function(){},aa.prototype.doResumeAd=function(){return this.videoSlot.play()},aa.prototype.doPause=function(){this.videoSlot.pause()},aa.prototype.videoOnClick=function(){var e=this,t=this.eventsCallbacks.AdClickThru;!this.attributes_.skipped&&t&&t.forEach(function(t){return t.callback(e.getClickUrl(),"1",!0)})},aa.prototype.getClickUrl=function(){for(var t=1e3*(this.attributes_.duration-this.getAdRemainingTime()),e=this.adParameters.clickUrls[0].destUrl,i=0,a=this.adParameters.clickUrls;i<a.length;i++){var o=a[i];if((!o.startTime||o.startTime<t)&&(!o.endTime||o.endTime>=t)){e=o.destUrl;break}}return e},aa.prototype.doExpandAd=function(){this.videoSlot.requestFullscreen&&this.videoSlot.requestFullscreen()},aa.prototype.doCollapseAd=function(){},aa.prototype.doSkipAd=function(){},aa.prototype.doSetAdVolume=function(){this.videoSlot.volume=this.getAdVolume()},aa.prototype.createSkipButtonElement=function(){var t=document.createElement("img");return t.className="skip",t.src=this.adParameters.skipButtonImageUrl,t.style.position="absolute",t.style.width="10%",t.style.height="10%",t.style.right="0px",t.style.top="70%",t.style.opacity="0.6",t.style.cursor="pointer",t.onmouseover=function(){return t.style.opacity="1"},t.onmouseout=function(){return t.style.opacity="0.6"},t},aa),_;function aa(){var t=null!==_&&_.apply(this,arguments)||this;return t.nestedVideoSlot=!1,t}window.getVPAIDAd=function(){return new VpaidVideoPlayer}}();
